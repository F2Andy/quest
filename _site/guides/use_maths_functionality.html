<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Use maths functionality</title>
    <link rel="stylesheet" href="/bootstrap.min.css">
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>

  <body>
    <div class="container">
      <h1>Use maths functionality</h1>
      <p>Text adventures do not have a lot of call for mathematics, but Quest does have a lot of maths functions built in nevertheless.</p>

<h2>Basic operations</h2>

<p>You know about +, -, * and /, right? Quest also supports ^ and %, for raising to the power, and modulo arithmetic.</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">  msg (&quot;2 to the 3 is &quot; + (2^3))
  msg (&quot;13 mod 3 is &quot; + (13 % 3))
</code></pre></div>
<h2>Rounding</h2>

<p>Three functions are available:</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">  x = 3.14
  msg (&quot;Floor &quot; + x + &quot; is &quot; + floor(x))
  msg (&quot;Ceiling &quot; + x + &quot; is &quot; + ceiling(x))
  msg (&quot;Round &quot; + x + &quot; is &quot; + round(x))
  x = 3.6
  msg (&quot;Floor &quot; + x + &quot; is &quot; + floor(x))
  msg (&quot;Ceiling &quot; + x + &quot; is &quot; + ceiling(x))
  msg (&quot;Round &quot; + x + &quot; is &quot; + round(x))
  x = -3.14
  msg (&quot;Floor &quot; + x + &quot; is &quot; + floor(x))
  msg (&quot;Ceiling &quot; + x + &quot; is &quot; + ceiling(x))
  msg (&quot;Round &quot; + x + &quot; is &quot; + round(x))
  x = -3.6
  msg (&quot;Floor &quot; + x + &quot; is &quot; + floor(x))
  msg (&quot;Ceiling &quot; + x + &quot; is &quot; + ceiling(x))
  msg (&quot;Round &quot; + x + &quot; is &quot; + round(x))
</code></pre></div>
<p>The output is:</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">  Floor 3.14 is 3
  Ceiling 3.14 is 4
  Round 3.14 is 3
  Floor 3.6 is 3
  Ceiling 3.6 is 4
  Round 3.6 is 4
  Floor -3.14 is -4
  Ceiling -3.14 is -3
  Round -3.14 is -3
  Floor -3.6 is -4
  Ceiling -3.6 is -3
  Round -3.6 is -4
</code></pre></div>
<h2>Minimum and maximum</h2>

<p>Use the min and max functions:</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">  msg (&quot;Min of 4 and 10 is &quot; + min (4, 10))
  msg (&quot;Max of 4 and 10 is &quot; + max (4, 10))
</code></pre></div>
<h2>Bitwise Operations</h2>

<p>If you are reading a page about maths, chances are you are familiar with Boolean operations such as:</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">  if (door.islocked and player.haskey)
</code></pre></div>
<p>... but the operations <em>and</em>, <em>or</em> and &#39;&#39;not&#39; can also be used with integers (but not with integers and Booleans mixed together).</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">  msg (&quot;bitwise 20 and 4 is &quot; + (20 and 4))
  msg (&quot;bitwise 20 or 4 is &quot; + (20 or 4))
</code></pre></div>
<p>Twenty is 10100 in binary and 4 is 100. When you <em>and</em> them, the result is every bit they have in common, in this case just the third. When you &#39;oor&#39;&#39; them, you get all the bits either of them have, the fifth and the third.</p>

<p>There is also a bitwise shift operator; it moves the binary representation of the number on the left by a number of places indicated by the number on the right (in effect, shift left multiples the right number by two to the power of the left number; right shuift divides by two to the power of the right number):.</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">  msg (&quot;24 shifted 3 right is &quot; + (24 &gt;&gt; 3))
  msg (&quot;3 shifted 3 left is &quot; + (3 &lt;&lt; 3))
</code></pre></div>
<p>2 to the power 3 is eight, so the first line effectively divides by 8, to give 3, the second line multiples by eight tio give 24.</p>

<p>Thirty to forty years ago, this might give a significant speed boost, compared to 24 / 8. Nowadays, with faster computers, it is pretty much useless.</p>

<h2>Tertiary Operator</h2>

<p>So called because it takes three values. If the first is true, it returns the second, otherwise it returns the third.</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">  msg (if (10 &gt; 5, &quot;yes it is&quot;, &quot;no it&#39;s not&quot;))
  msg (if (10 &lt; 5, &quot;yes it is&quot;, &quot;no it&#39;s not&quot;))
  s = if (10 &lt; 5, &quot;yes it is&quot;, &quot;no it&#39;s not&quot;)
  msg (s)
</code></pre></div>
<p>The third line, for example, would otherwise be written like this:</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">  if (10 &lt; 5)
    s = &quot;yes it is&quot;
  }
  else {
    s = &quot;no it&#39;s not&quot;
  }
</code></pre></div>
<h2>The in Operator</h2>

<p>Evaluates to true if the term on the left is in the list on the right, false otherwise.</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">  list = Split (&quot;one,two,three,four&quot;, &quot;,&quot;)
  msg (&quot;Is it is the list? two or zero&quot;)
  msg (&quot;two&quot; in list)
  msg (&quot;zero&quot; in list)
</code></pre></div>
<p>The first line creates our list. the third line prints &quot;true&quot;, as &quot;two&quot; is found in the list, the last line prints &quot;false&quot;; &quot;zero&quot; is not in the list.</p>

<p>If you look at the documentation, you will see this can be used in another form,</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">  msg (&quot;two&quot; in &quot;on e&quot;, &quot;two&quot;, &quot;three&quot;)
</code></pre></div>
<p>This is not supported by quest.</p>

<h2>Miscellaneous Functions</h2>

<p>Every felt you cannot create the adventure game of your dreams because Quest does not support hyperbolic cosine? Fret no more!</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">  msg (&quot;Absolute value of -2 is &quot; + abs (-2))
  msg (&quot;Sign  of -2 is &quot; + sign (-2))
  msg (&quot;Square root of 2 is &quot; + sqrt (2))
  msg (&quot;Cosine 0.5 is &quot; + cos (0.5))
  msg (&quot;Inverse cosine 0.5 is &quot; + acos (0.5))
  msg (&quot;Cosh 0.5 is &quot; + cosh (0.5))
  msg (&quot;2 to the 3 is &quot; + pow (2, 3))
  msg (&quot;The log base 10 of 7 is &quot; + log10(7))
  msg (&quot;The natural log of 7 is &quot; + log(7))
  msg (&quot;e to the power of 7 is &quot; + exp(7))
</code></pre></div>
<p>In case you are wondering, abs gets the absolute value, i.e., makes it a positive value. The sign function returns -1 for negative numbers, 1 for positive, and zero for zero.</p>

<h2>Constants <em>e</em> and <em>pi</em></h2>

<p>They are irrational! They are transcendental! They are right there in quest!</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">  msg (&quot;e is &quot; + e)
  msg (&quot;pi is &quot; + pi)
</code></pre></div>
<p>Quest will actually allow you to go through the motions of assigning a value to these:</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">  e = game.pov
  msg (e)
</code></pre></div>
<p>No error will be given, but e will still be 2.718... Using e or pi as a variable name can lead to some very mysterious errors.</p>

<h2>Indexing</h2>

<p>In most languages you can index an element in a array (or list, as they are also termed) with something like this:</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">  myarray[5]
</code></pre></div>
<p>It works in Quest too. You can even do it for a dictionary:</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">  mydictionary[&quot;peter&quot;]
</code></pre></div>
<p>However, occasionally it does not work. It depends on how Quest sees the result; it might not spot that the value it has is a string, rather than an object, and if that happens you will get an error like this:</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">  Error running script: Error compiling expression &#39;list[1]&#39;: RootExpressionElement: Cannot convert type &#39;Object&#39; to expression result of &#39;String&#39;
</code></pre></div>
<p>Here is an example (TestFunc just prints out the value):</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">  list = Split (&quot;one,two,three,four&quot;, &quot;,&quot;)
  msg (&quot;number 2 is &quot; + list[2])
  d = NewDictionary()
  dictionary add (d, &quot;Name&quot;, &quot;Quest&quot;)
  dictionary add (d, &quot;Author&quot;, &quot;Alex Warren&quot;)
  msg (d[&quot;Name&quot;])
  TestFunc (list[1])
  dictionary add (d, &quot;&quot; + list[1], list[2])
  msg (d[&quot;two&quot;])
</code></pre></div>
<p>The only time in the above that there is a problem is when adding the value to a dictionary as the key on penultimate line, and so instead of:</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">  dictionary add (d, list[1], list[2])
</code></pre></div>
<p>... I have:</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">  dictionary add (d, &quot;&quot; + list[1], list[2])
</code></pre></div>
<p>... which forces the value to be a string. It is not clear exactly when this is required, but most cases work fine. The message here is to test properly!</p>

<h2>Example game</h2>

<p>Okay, so you want to see this is action?</p>

<p><a href="http://play.textadventures.co.uk/Play.aspx?id=drlmaqlj1kswth91oz0qja">1</a></p>

<h2>Credits</h2>

<p>Jay Nabonne discovered most of this on the Quest forum.</p>

    </div>
  </body>
</html>
